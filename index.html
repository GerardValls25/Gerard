<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gerard Valls - Nutrición Profesional</title>

<!-- Fuente -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Font Awesome CSS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

<!-- Chart.js para la calculadora -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollTrigger.min.js" defer></script>

<style>
:root{
  --primary:#00ffc0;
  --primary-hover:#00e6b8;
  --dark-bg:#1a1f3f;
  --light-bg:#f5f5f5;
  --text-dark:#e6e6e6;
  --text-light:#222;
  --radius:12px;
  --transition:.5s ease;
}
*{box-sizing:border-box;}
body{
  margin:0; font-family:'Montserrat',sans-serif;
  background:var(--dark-bg);
  color:var(--text-dark);
  overflow-x:hidden; line-height:1.6;
}
body.light{background:var(--light-bg); color:var(--text-light);}
a{color:var(--primary); text-decoration:none; transition:.3s;}
a:hover{color:var(--primary-hover);}

/* HEADER */
header{text-align:center;padding:120px 20px 100px;}
header h1{
  font-size:3rem;
  background:linear-gradient(90deg,#00ffc0,#00bfff,#ff00c8,#ffbf00);
  -webkit-background-clip:text;
  color:transparent;
  text-shadow:0 0 20px rgba(0,255,192,0.5);
  animation:gradMove 10s linear infinite;
}
@keyframes gradMove{0%{background-position:0 0;}50%{background-position:100% 0;}100%{background-position:0 0;}}

/* Navegación */
nav{position:sticky;top:0;background:rgba(42,55,96,0.85);backdrop-filter:blur(10px);display:flex;justify-content:center;gap:1rem;padding:12px;z-index:1000;}
body.light nav{background:rgba(245,245,245,0.9);}
nav a{font-weight:600;cursor:pointer;}

/* Main */
main.wrapper{max-width:1100px;margin:40px auto;padding:50px 30px;background:rgba(42,55,96,0.85);border-radius:var(--radius);backdrop-filter:blur(15px);}
body.light main.wrapper{background:rgba(245,245,245,0.9);}

h2{font-size:2rem;margin-bottom:20px;position:relative;display:inline-block;}
h2::after{content:"";width:60px;height:3px;display:block;margin:8px auto 0;border-radius:2px;background:var(--primary);transform:scaleX(0);animation:lineDraw 1s forwards;}
@keyframes lineDraw{to{transform:scaleX(1);}}

/* Servicios (igual que antes) */
.services{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:30px;perspective:1200px;}
.service-inner{position:relative;width:100%;min-height:250px;transform-style:preserve-3d;transition:transform .8s;}
.service:hover .service-inner{transform:rotateY(180deg);}
.service-front,.service-back{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:var(--radius);padding:25px;display:flex;flex-direction:column;justify-content:center;align-items:center;}
.service-front{background:rgba(255,255,255,0.05);}
.service-front i{font-size:3rem;margin-bottom:10px;color:var(--primary);}
.service-back{background:linear-gradient(135deg,#00ffc0,#00bfff);transform:rotateY(180deg);color:#000;}

/* BOTÓN flotante de calculadora */
#btn-calculadora {
  position: fixed;
  bottom: 220px;
  right: 20px;
  background: var(--primary);
  color: #000;
  border: none;
  border-radius: 50%;
  width: 60px;
  height: 60px;
  font-size: 1.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
  transition: .3s;
  z-index: 1000;
}
#btn-calculadora:hover{transform:scale(1.1);background:var(--primary-hover);}

/* MODAL Calculadora */
#calorie-modal {
  display: none;
  justify-content: center;
  align-items: center;
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(6px);
  z-index: 2000;
}
#calorie-modal .modal-content {
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(12px);
  border-radius: 20px;
  padding: 25px;
  width: 90%;
  max-width: 450px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.3);
  position: relative;
}
#calorie-modal .close {
  position: absolute;
  top: 12px;
  right: 15px;
  font-size: 20px;
  cursor: pointer;
  color: white;
}
#calorie-modal input,#calorie-modal select {
  width: 100%;
  padding: 10px;
  margin: 8px 0;
  border-radius: 12px;
  border: none;
  background: rgba(255, 255, 255, 0.2);
  color: white;
}
.error-message { color:#ff4d4d;font-size:0.9rem;margin-top:4px; }
input.error,select.error { border:2px solid #ff4d4d !important; }

#resultado{text-align:center;font-weight:bold;margin-top:10px;}
#toggleChartMode{background:rgba(255,255,255,0.2);color:white;border:none;padding:8px 16px;border-radius:10px;margin-top:10px;cursor:pointer;}
</style>
</head>
<body>

<header>
  <h1>Gerard Valls</h1>
  <p>Nutrición personalizada para deportistas y personas activas</p>
</header>

<nav>
  <a href="#servicios">Servicios</a>
  <a href="#testimonios">Testimonios</a>
  <a href="#consulta">Formulario</a>
</nav>

<main class="wrapper">
  <!-- Aquí tus secciones de servicios, testimonios y formulario (no modificadas) -->
</main>

<!-- Botón flotante para abrir la calculadora -->
<button id="btn-calculadora" aria-label="Abrir Calculadora"><i class="fas fa-calculator"></i></button>

<!-- Modal Calculadora -->
<div id="calorie-modal">
  <div class="modal-content">
    <span class="close" onclick="cerrarCalculadora()">✖</span>
    <h2 style="text-align:center;color:white;">Calculadora de Calorías</h2>
    <form id="calorie-form">
      <input type="number" id="peso" placeholder="Peso (kg)" required>
      <input type="number" id="altura" placeholder="Altura (cm)" required>
      <input type="number" id="edad" placeholder="Edad" required>
      <select id="sexo" required>
        <option value="">Sexo</option>
        <option value="M">Hombre</option>
        <option value="F">Mujer</option>
      </select>
      <select id="actividad" required>
        <option value="">Nivel de actividad</option>
        <option value="1.2">Sedentario</option>
        <option value="1.375">Ligero</option>
        <option value="1.55">Moderado</option>
        <option value="1.725">Activo</option>
        <option value="1.9">Muy Activo</option>
      </select>
      <select id="objetivo" required>
        <option value="cut">Pérdida de peso</option>
        <option value="maintain">Mantenimiento</option>
        <option value="bulk">Volumen</option>
      </select>
      <button type="submit">Calcular</button>
    </form>
    <p id="resultado"></p>
    <canvas id="macroChart" width="300" height="300"></canvas>
    <button type="button" id="toggleChartMode">Ver en gramos</button>
    <p id="resumen-macros"></p>
  </div>
</div>

<footer>&copy; 2025 Gerard Valls - Todos los derechos reservados.</footer>

<script>
/* Abrir/cerrar calculadora */
document.getElementById("btn-calculadora").addEventListener("click",()=>document.getElementById("calorie-modal").style.display="flex");
function cerrarCalculadora(){document.getElementById("calorie-modal").style.display="none";}

/* Lógica de la calculadora */
const form=document.getElementById("calorie-form");
const resultado=document.getElementById("resultado");
const resumenMacros=document.getElementById("resumen-macros");
let chart,mostrarEnGramos=false;

form.addEventListener("submit",e=>{
  e.preventDefault();
  document.querySelectorAll(".error-message").forEach(el=>el.remove());
  document.querySelectorAll("#calorie-form input,#calorie-form select").forEach(el=>el.classList.remove("error"));
  let valido=true;
  function marcarError(campo,msg){
    campo.classList.add("error");
    const m=document.createElement("div");
    m.className="error-message"; m.textContent=msg;
    campo.insertAdjacentElement("afterend",m); valido=false;
  }
  const peso=parseFloat(document.getElementById("peso").value);
  const altura=parseFloat(document.getElementById("altura").value);
  const edad=parseInt(document.getElementById("edad").value);
  const sexo=document.getElementById("sexo");
  const actividad=document.getElementById("actividad");
  const objetivo=document.getElementById("objetivo");
  if(isNaN(peso)||peso<30||peso>300)marcarError(document.getElementById("peso"),"Peso inválido (30-300 kg)");
  if(isNaN(altura)||altura<100||altura>250)marcarError(document.getElementById("altura"),"Altura inválida (100-250 cm)");
  if(isNaN(edad)||edad<10||edad>100)marcarError(document.getElementById("edad"),"Edad inválida (10-100 años)");
  if(!sexo.value)marcarError(sexo,"Selecciona tu sexo");
  if(!actividad.value)marcarError(actividad,"Selecciona tu actividad");
  if(!objetivo.value)marcarError(objetivo,"Selecciona tu objetivo");
  if(!valido){resultado.textContent="⚠️ Revisa los campos resaltados."; return;}
  let bmr=sexo.value==="M"?10*peso+6.25*altura-5*edad+5:10*peso+6.25*altura-5*edad-161;
  let tdee=bmr*parseFloat(actividad.value);
  if(objetivo.value==="cut")tdee-=500;
  if(objetivo.value==="bulk")tdee+=300;
  resultado.textContent=`Necesitas aproximadamente ${Math.round(tdee)} kcal/día.`;
  const macros={carbs:tdee*0.4,protein:tdee*0.3,fat:tdee*0.3};
  actualizarGrafico(macros);
});

function actualizarGrafico(macros){
  const ctx=document.getElementById("macroChart").getContext("2d");
  const data={labels:["Carbohidratos","Proteínas","Grasas"],datasets:[{data:[
    mostrarEnGramos?macros.carbs/4:macros.carbs,
    mostrarEnGramos?macros.protein/4:macros.protein,
    mostrarEnGramos?macros.fat/9:macros.fat
  ],backgroundColor:["#00bfff","#ff7eb3","#ffe259"]}]};
  const options={plugins:{legend:{labels:{color:"white"}},tooltip:{callbacks:{label:ctx=>mostrarEnGramos?`${ctx.label}: ${ctx.formattedValue} g`:`${ctx.label}: ${ctx.formattedValue} kcal`}}}};
  if(chart){chart.data=data; chart.update();}
  else{chart=new Chart(ctx,{type:"doughnut",data,options});}
  resumenMacros.textContent=mostrarEnGramos?`Carbs: ${(macros.carbs/4).toFixed(0)}g | Prot: ${(macros.protein/4).toFixed(0)}g | Grasas: ${(macros.fat/9).toFixed(0)}g`:`Carbs: ${macros.carbs.toFixed(0)} kcal | Prot: ${macros.protein.toFixed(0)} kcal | Grasas: ${macros.fat.toFixed(0)} kcal`;
}
document.getElementById("toggleChartMode").addEventListener("click",()=>{
  mostrarEnGramos=!mostrarEnGramos;
  document.getElementById("toggleChartMode").textContent=mostrarEnGramos?"Ver en kcal":"Ver en gramos";
  form.dispatchEvent(new Event("submit"));
});
</script>
</body>
</html>
