<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Calor√≠as</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

<style>
body{
  font-family:'Montserrat',sans-serif;
  background:#1a1f3f;
  color:#e6e6e6;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  min-height:100vh;
  margin:0;
}
h1{color:#00ffc0;text-align:center;margin-bottom:20px;}
.glass-form{
  display:flex;
  flex-direction:column;
  gap:20px;
  padding:30px;
  border-radius:16px;
  background:rgba(255,255,255,0.05);
  backdrop-filter:blur(15px);
  border:1px solid rgba(255,255,255,0.2);
  width:300px;
}
.form-group{position:relative;}
.form-group input,.form-group select{
  width:100%;
  padding:14px 12px 14px 36px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,0.3);
  background:rgba(255,255,255,0.1);
  color:white;
}
.form-group label{
  position:absolute;
  left:36px;
  top:50%;
  transform:translateY(-50%);
  color:rgba(255,255,255,0.6);
  pointer-events:none;
  transition:.3s;
}
.form-group input:focus+label,
.form-group input:not(:placeholder-shown)+label,
.form-group select:focus+label{
  top:-8px;
  font-size:0.8rem;
  color:#00ffc0;
}
button{
  background:#00ffc0;
  color:#000;
  border:none;
  padding:14px;
  border-radius:12px;
  cursor:pointer;
  font-weight:600;
}
button:hover{background:#00e6b8;}
#resultado{margin-top:20px;text-align:center;}
canvas{max-width:400px;margin-top:20px;}
</style>
</head>
<body>

<h1>Calculadora de Calor√≠as</h1>

<form id="calc-form" class="glass-form">
  <div class="form-group">
    <input type="number" id="peso" placeholder=" " required>
    <label>Peso (kg)</label><i class="fas fa-weight"></i>
  </div>
  <div class="form-group">
    <input type="number" id="altura" placeholder=" " required>
    <label>Altura (cm)</label><i class="fas fa-ruler-vertical"></i>
  </div>
  <div class="form-group">
    <input type="number" id="edad" placeholder=" " required>
    <label>Edad</label><i class="fas fa-user"></i>
  </div>
  <div class="form-group">
    <select id="actividad" required>
      <option value="">Nivel de actividad</option>
      <option value="1.2">Sedentario</option>
      <option value="1.375">Ligera</option>
      <option value="1.55">Moderada</option>
      <option value="1.725">Intensa</option>
    </select>
    <label>Actividad</label>
  </div>
  <button type="submit">Calcular</button>
</form>

<div id="resultado"></div>
<canvas id="graficoMacros"></canvas>
<button id="descargarPDF" style="display:none;margin-top:10px;">üìÑ Descargar PDF</button>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
let chart;
document.getElementById("calc-form").addEventListener("submit",e=>{
  e.preventDefault();
  const peso=+document.getElementById("peso").value;
  const altura=+document.getElementById("altura").value;
  const edad=+document.getElementById("edad").value;
  const actividad=+document.getElementById("actividad").value;

  const tmb=10*peso+6.25*altura-5*edad+5;
  const mantenimiento=tmb*actividad;
  const deficit=mantenimiento-500;
  const superavit=mantenimiento+300;

  document.getElementById("resultado").innerHTML=`
    <strong>TMB:</strong> ${tmb.toFixed(0)} kcal<br>
    <strong>Mantenimiento:</strong> ${mantenimiento.toFixed(0)} kcal<br>
    <strong>D√©ficit recomendado:</strong> ${deficit.toFixed(0)} kcal<br>
    <strong>Super√°vit recomendado:</strong> ${superavit.toFixed(0)} kcal
  `;

  actualizarGrafico(mantenimiento);
});

function actualizarGrafico(calorias){
  const proteinas=(calorias*0.3)/4;
  const carbos=(calorias*0.4)/4;
  const grasas=(calorias*0.3)/9;

  const ctx=document.getElementById("graficoMacros");
  if(chart) chart.destroy();
  chart=new Chart(ctx,{
    type:"doughnut",
    data:{
      labels:["Prote√≠nas","Carbohidratos","Grasas"],
      datasets:[{
        data:[proteinas,carbos,grasas],
        backgroundColor:["#00ffc0","#00bfff","#ff00c8"],
        borderWidth:1
      }]
    },
    options:{
      plugins:{
        tooltip:{callbacks:{label:(ctx)=>`${ctx.label}: ${ctx.parsed.toFixed(0)} g`}},
        legend:{position:"bottom"}
      },
      animation:{animateScale:true}
    }
  });

  document.getElementById("descargarPDF").style.display="inline-block";
}

document.getElementById("descargarPDF").addEventListener("click",()=>{
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const primaryColor=[0,255,192];
  const darkText=[40,40,40];

  doc.setFontSize(22);
  doc.setTextColor(...primaryColor);
  doc.text("Resultados de la Calculadora",105,20,{align:"center"});

  const textoPlano=document.getElementById("resultado").innerText.split("\n");
  let y=40;
  doc.setFontSize(12);
  textoPlano.forEach(linea=>{
    if(linea.includes("Mantenimiento")) doc.setTextColor(34,197,94);
    else if(linea.includes("D√©ficit")) doc.setTextColor(239,68,68);
    else if(linea.includes("Super√°vit")) doc.setTextColor(59,130,246);
    else doc.setTextColor(...darkText);
    doc.text(linea,20,y);
    y+=8;
  });

  const canvas=document.getElementById("graficoMacros");
  const imgData=canvas.toDataURL("image/png",1.0);
  doc.addImage(imgData,"PNG",20,y+5,170,90);

  doc.setFontSize(10);
  doc.setTextColor(...darkText);
  doc.text("Generado por Gerard Valls - Nutrici√≥n Profesional",105,290,{align:"center"});

  doc.save("resultados-macros.pdf");
});
</script>

</body>
</html>
