
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gerard Valls - Nutrici√≥n Profesional ULTRA PREMIUM</title>
<meta name="description" content="Pierde grasa y gana m√∫sculo con planes personalizados y asesor√≠a profesional de Gerard Valls. Resultados sostenibles y medibles.">

<!-- Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.14.1/gsap.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.14.1/ScrollTrigger.min.js" defer></script>

<!-- Three.js -->
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/controls/OrbitControls.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/postprocessing/EffectComposer.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/postprocessing/RenderPass.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/postprocessing/UnrealBloomPass.js"></script>

<!-- Stripe -->
<script src="https://js.stripe.com/v3/"></script>

<style>
:root {
  --primary: #00ffc0;
  --secondary: #ffbf00;
  --darkbg: #1a1f3f;
  --text-light: #e6e6e6;
  --radius: 20px;
  --transition: 0.4s ease;
  --card-bg: rgba(255,255,255,0.05);
  --card-shadow: 0 12px 40px rgba(0,0,0,0.55);
}
* { box-sizing: border-box; margin:0; padding:0; }
body { font-family: 'Montserrat', sans-serif; background: var(--darkbg); color: var(--text-light); line-height:1.5; overflow-x:hidden; }
a { text-decoration:none; color: var(--primary); transition: var(--transition); }
a:hover { color: var(--secondary); }
canvas { position: fixed; top:0; left:0; width:100%; height:100%; z-index:-1; }

/* MEN√ö SUPERIOR NE√ìN */
#main-nav {
  position: fixed;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 95%;
  max-width: 1200px;
  background: rgba(10,10,25,0.6);
  backdrop-filter: blur(15px);
  border-radius: 15px;
  box-shadow: 0 4px 20px rgba(0,255,192,0.3);
  z-index: 1000;
}
#main-nav ul {
  display:flex;
  justify-content: space-around;
  list-style: none;
  padding: 10px 0;
  margin:0;
}
.neon-link {
  color: #00ffc0;
  font-weight:600;
  font-size:0.95rem;
  padding:6px 12px;
  border-radius:10px;
  text-shadow:
     0 0 5px #00ffc0,
     0 0 10px #00ffc0,
     0 0 20px #00ffc0,
     0 0 40px #00bfff,
     0 0 80px #00bfff;
  transition: all 0.3s ease-in-out;
  position: relative;
  animation: neon-flicker 2.5s infinite;
}
.neon-link:hover {
  color: #ffbf00;
  text-shadow:
     0 0 5px #ffbf00,
     0 0 10px #ffbf00,
     0 0 20px #ffbf00,
     0 0 40px #ffbf00,
     0 0 80px #ffbf00;
  background: rgba(0,0,0,0.2);
}
@keyframes neon-flicker {
  0%, 18%, 22%, 25%, 53%, 57%, 100% { text-shadow: 
    0 0 5px #00ffc0,
    0 0 10px #00ffc0,
    0 0 20px #00ffc0,
    0 0 40px #00bfff,
    0 0 80px #00bfff;
  }
  20%, 24%, 55% { text-shadow: none; color:#00ffc0; }
}

/* Secciones */
section {
  max-width: 1100px;
  margin: 100px auto;
  padding: 60px 30px;
  border-radius: var(--radius);
  backdrop-filter: blur(12px);
  background: var(--card-bg);
  box-shadow: var(--card-shadow);
}

/* Header */
header { text-align:center; padding:140px 20px 60px; }
header {
  text-align: center;
  padding: 180px 20px 60px; 
}

header img {
  width: 100%;           /* ocupa todo el ancho posible */
  max-width: 900px;      /* aumenta tama√±o m√°ximo en pantallas grandes */
  height: auto;          /* mantiene proporci√≥n */
  border-radius: 20px;   /* bordes suaves, puedes poner 0 si quieres recta */
  box-shadow: 0 25px 60px rgba(0,0,0,0.7);
  margin-bottom: 30px;
  display: block;
  margin-left: auto;
  margin-right: auto;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

header img:hover {
  transform: scale(1.03);
  box-shadow: 0 30px 70px rgba(0,0,0,0.8);
}

/* Responsivo */
@media(max-width: 1200px){
  header img { max-width: 700px; }
}
@media(max-width: 992px){
  header img { max-width: 500px; }
}
@media(max-width: 768px){
  header img { max-width: 350px; }
}
@media(max-width: 480px){
  header img { max-width: 250px; }
}
header h1 { font-size:2.2rem; background: linear-gradient(90deg, #00ffc0,#00bfff,#ff00c8,#ffbf00); -webkit-background-clip:text; color:transparent; text-shadow:0 0 15px rgba(0,255,192,0.3); margin-bottom:10px; line-height:1.2; }
header p { font-size:1rem; max-width:600px; margin:auto; opacity:0; transform:translateY(20px); animation: fadeInUp 1s forwards 0.5s; }
header .cta { margin-top:25px; display:flex; justify-content:center; gap:20px; flex-wrap:wrap; }
header .cta button, header .cta a { padding:12px 28px; border-radius: var(--radius); font-weight:600; cursor:pointer; transition: var(--transition); font-size:0.95rem; }
header .cta button { background: var(--secondary); color:#000; border:none; }
header .cta button:hover { background: var(--primary); transform:translateY(-2px); box-shadow:0 5px 15px rgba(0,255,192,0.3);}
header .cta a { border:2px solid var(--primary); color: var(--primary); }
header .cta a:hover { background: var(--primary); color:#000; box-shadow:0 5px 15px rgba(0,255,192,0.3); }

/* Grid cards */
.grid {
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(220px,1fr));
  gap:25px;
}
.grid .card {
  padding:20px;
  border-radius: var(--radius);
  background: var(--card-bg);
  backdrop-filter:blur(12px);
  box-shadow: var(--card-shadow);
  text-align:center;
  transition: var(--transition);
  display:flex;
  flex-direction:column;
  justify-content:center;
}
.grid .card:hover {
  transform:translateY(-5px) scale(1.02);
  box-shadow:0 16px 45px rgba(0,0,0,0.6);
}
.grid .card i { font-size:2rem; margin-bottom:10px; }
.grid .card h3 { font-size:1.15rem; margin-bottom:6px; font-weight:600; }
.grid .card p { font-size:0.9rem; opacity:0.85; line-height:1.4; }

/* Footer */
footer { text-align:center; padding:30px; font-size:0.85rem; opacity:0.7; }

/* Animaciones */
@keyframes fadeInUp { to { opacity:1; transform:translateY(0); } }

/* Suscripciones premium */
.subscription-card {
  background: linear-gradient(145deg, rgba(0,255,192,0.05), rgba(0,191,255,0.1));
  border-radius: var(--radius);
  padding: 25px;
  text-align: center;
  box-shadow: 0 0 25px rgba(0,255,192,0.4), 0 0 50px rgba(0,191,255,0.3);
  transition: all 0.3s ease;
}
.subscription-card:hover {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 0 0 35px rgba(0,255,192,0.6), 0 0 60px rgba(0,191,255,0.5);
}
.subscription-card h3 {
  font-size:1.2rem;
  margin-bottom:10px;
  font-weight:700;
  background: linear-gradient(90deg, #00ffc0,#00bfff,#ff00c8,#ffbf00);
  -webkit-background-clip: text;
  color: transparent;
}
.subscription-card button {
  margin-top:15px;
  padding:12px 20px;
  border-radius: var(--radius);
  font-weight:600;
  color:#000;
  background:#ffbf00;
  border:none;
  cursor:pointer;
  box-shadow: 0 0 15px #ffbf00, 0 0 30px #ffbf00 inset;
  transition: all 0.3s ease-in-out;
  animation: pulse 2s infinite;
}
.subscription-card button:hover {
  background: #00ffc0;
  box-shadow: 0 0 25px #00ffc0, 0 0 50px #00bfff inset;
  transform: scale(1.05);
}
.subscription-card.premium {
  transform: scale(1.05);
  border: 2px solid #00ffc0;
  box-shadow: 0 0 35px #00ffc0, 0 0 70px #00bfff inset;
  animation: neonGlow 2.5s infinite alternate;
}
@keyframes neonGlow {
  0% { box-shadow: 0 0 20px #00ffc0, 0 0 50px #00bfff inset; }
  50% { box-shadow: 0 0 40px #00ffc0, 0 0 80px #00bfff inset; }
  100% { box-shadow: 0 0 20px #00ffc0, 0 0 50px #00bfff inset; }
}

/* Responsivo */
@media(max-width:768px){
  header h1 { font-size:1.8rem; }
  header p { font-size:0.95rem; }
  .grid { gap:15px; }
  .grid .card { padding:15px; }
}

/* Modal Premium Unificado */
.premium-modal {
  background: rgba(17,17,17,0.9);
  padding:30px;
  border-radius: var(--radius);
  width:90%;
  max-width:400px;
  display:flex;
  flex-direction:column;
  gap:15px;
  box-shadow: 0 0 25px #00ffc0, 0 0 50px #00bfff inset;
  border: 2px solid #00ffc0;
  position: relative;
  animation: neonBorder 2.5s infinite alternate;
  transition: transform 0.3s ease, opacity 0.3s ease;
}
@keyframes neonBorder {
  0% { box-shadow: 0 0 20px #00ffc0, 0 0 40px #00bfff inset; border-color: #00ffc0; }
  50% { box-shadow: 0 0 35px #00ffc0, 0 0 70px #00bfff inset; border-color: #00bfff; }
  100% { box-shadow: 0 0 20px #00ffc0, 0 0 40px #00bfff inset; border-color: #00ffc0; }
}
.premium-modal h3 { text-align:center; font-size:1.5rem; background: linear-gradient(90deg, #00ffc0,#00bfff,#ff00c8,#ffbf00); -webkit-background-clip:text; color:transparent; margin-bottom:10px; }
.premium-modal input { padding:10px; border-radius: var(--radius); border:none; background: rgba(255,255,255,0.1); color:#fff; font-size:0.95rem; transition: 0.3s; }
.premium-modal input:focus { outline:2px solid #00ffc0; background: rgba(255,255,255,0.15); }
.premium-modal button[type="submit"] { padding:12px 20px; border:none; border-radius: var(--radius); background:#ffbf00; color:#000; font-weight:700; cursor:pointer; box-shadow: 0 0 15px #ffbf00, 0 0 30px #ffbf00 inset; transition: all 0.3s ease-in-out; animation: pulse 2s infinite; }
.premium-modal button[type="submit"]:hover { background: #00ffc0; box-shadow: 0 0 25px #00ffc0, 0 0 50px #00bfff inset; transform: scale(1.05); }
.premium-modal button#close-unificado { padding:8px; border:none; border-radius: var(--radius); background: rgba(255,0,0,0.5); color:#fff; cursor:pointer; }
</style>
</head>
<body>

<!-- Header -->
<header id="header">
  <img src="gerard.jpg" alt="Gerard Valls, especialista en nutrici√≥n profesional">
  <h1>Pierde grasa y gana m√∫sculo sin dejar de comer lo que m√°s te gusta</h1>
  <p>M√©todo estrat√©gico basado en evidencia cient√≠fica para resultados reales y sostenibles.</p>
  <div class="cta">
    <button id="cta-reserva">EMPEZAR MI CAMBIO AHORA</button>
    <a href="#servicios" class="neon-link">VER PROGRAMAS</a>
    <a href="calculadora.html" class="neon-link">Calculadora</a>
    <a href="imc.html" class="neon-link">IMC</a>
  </div>
</header>

<!-- Servicios -->
<section id="servicios">
  <h2 style="text-align:center;font-size:1.8rem;margin-bottom:25px;">Servicios</h2>
  <div class="grid">
    <div class="card"><i class="fas fa-bowl-food" style="color:#00ffc0;"></i><h3>Planes Personalizados</h3><p>Adaptados a tu estilo de vida y objetivos.</p></div>
    <div class="card"><i class="fas fa-person-running" style="color:#00bfff;"></i><h3>Asesor√≠a Deportiva</h3><p>Optimiza tu rendimiento y recuperaci√≥n.</p></div>
    <div class="card"><i class="fas fa-scale-balanced" style="color:#ffbf00;"></i><h3>P√©rdida de Peso</h3><p>Programas sostenibles y personalizados.</p></div>
    <div class="card"><i class="fas fa-laptop" style="color:#ff00c8;"></i><h3>Consultas Online</h3><p>Asesor√≠a desde la comodidad de tu hogar.</p></div>
  </div>
</section>

<!-- =========================== -->
<!-- OFERTA LIMITADA + GARANT√çA + FAQ + LEAD MAGNET -->
<!-- =========================== -->

<section id="oferta-limitada">
  <h2 style="text-align:center;font-size:1.8rem;margin-bottom:25px;">üî• Oferta Especial Solo por este Mes üî•</h2>
  <div class="grid">
    <div class="card subscription-card premium">
      <h3>Suscripci√≥n Anual -10%</h3>
      <p style="font-size:1.6rem;font-weight:700;">
        <span style="text-decoration:line-through; opacity:0.6;">‚Ç¨510</span> ‚Üí ‚Ç¨459 / 12 meses
      </p>
      <ul style="text-align:left; margin:15px 0; padding-left:20px; line-height:1.5;">
        <li>Acceso completo a todos los planes</li>
        <li>Soporte prioritario 24/7</li>
        <li>Descuento v√°lido solo hasta fin de mes</li>
      </ul>
      <button>¬°APROVECHAR AHORA!</button>
      

<p id="contador" style="text-align:center; margin-top:15px; color:#ffbf00; font-weight:600;">
  ‚ö° Quedan solo <span id="plazas"></span> plazas disponibles
</p>

<p id="fecha-limite" style="text-align:center; margin-top:5px; opacity:0.8;"></p>
</section>

<section id="garantia">
  <h2 style="text-align:center;font-size:1.8rem;margin-bottom:25px;">‚úÖ Garant√≠a de Resultados</h2>
  <div class="grid">
    <div class="card"><i class="fas fa-shield-alt" style="color:#00ffc0;"></i>
      <h3>100% Seguro</h3>
      <p>Si no ves resultados en 30 d√≠as, te devolvemos tu dinero.</p>
    </div>
    <div class="card"><i class="fas fa-thumbs-up" style="color:#ffbf00;"></i>
      <h3>Confianza Total</h3>
      <p>M√°s de 200 transformaciones exitosas certifican nuestro m√©todo.</p>
    </div>
    <div class="card"><i class="fas fa-user-check" style="color:#00bfff;"></i>
      <h3>Profesional Certificado</h3>
      <p>Gerard Valls, experto en nutrici√≥n, con asesor√≠a personalizada.</p>
    </div>
  </div>
</section>

<section id="faq">
  <h2 style="text-align:center;font-size:1.8rem;margin-bottom:25px;">‚ùì Preguntas Frecuentes</h2>
  <div class="grid">
    <div class="card">
      <h3>¬øPuedo cancelar cuando quiera?</h3>
      <p>S√≠, las suscripciones mensuales y trimestrales pueden cancelarse en cualquier momento sin penalizaci√≥n.</p>
    </div>
    <div class="card">
      <h3>¬øEs necesario asistir presencialmente?</h3>
      <p>No, todos los planes incluyen consultor√≠a online y seguimiento digital.</p>
    </div>
    <div class="card">
      <h3>¬øRecibir√© un plan personalizado?</h3>
      <p>S√≠, todos los planes se adaptan a tus objetivos, estilo de vida y necesidades nutricionales.</p>
    </div>
  </div>
</section>

<!-- Suscripciones Optimizado con Badge -->
<section id="suscripciones">
  <h2 style="text-align:center;font-size:1.8rem;margin-bottom:40px;">Planes de Suscripci√≥n</h2>
  <div class="grid">
    
    <!-- Mensual -->
    <div class="card subscription-card">
      <h3>Suscripci√≥n Mensual</h3>
      <p style="font-size:1.5rem;font-weight:700;">‚Ç¨50 / mes</p>
      <ul style="text-align:left; margin:15px 0; padding-left:20px; line-height:1.5;">
        <li><em>*Facturado mensualmente</em></li>
        <li>Acceso mensual a todos los planes</li>
        <li>Ideal para probar</li>
        <li>Soporte b√°sico online</li>
      </ul>
      <button>√öNETE AHORA</button>
    </div>
    
    <!-- Trimestral -->
    <div class="card subscription-card">
      <h3>Suscripci√≥n Trimestral</h3>
      <p style="font-size:1.5rem;font-weight:700;">‚Ç¨135 / 3 meses <span style="font-size:1rem; color:#ffbf00;">(‚Ç¨45 / mes)</span></p>
      <ul style="text-align:left; margin:15px 0; padding-left:20px; line-height:1.5;">
        <li><em>*Facturado trimestral</em></li>
        <li>Plan flexible y accesible</li>
        <li>Actualizaci√≥n peri√≥dica de planes</li>
        <li>Soporte online prioritario</li>
        <li><strong>Ahorra ‚Ç¨5 / mes comparado con mensual</strong></li>
      </ul>
      <button>√öNETE AHORA</button>
    </div>
    
    <!-- Anual con Badge -->
    <div class="card subscription-card premium" style="position:relative;">
      <!-- Badge Mejor Valor -->
      <div style="position:absolute; top:-12px; right:-12px; background:#00ffc0; color:#000; font-weight:700; padding:6px 12px; border-radius:50px; text-shadow:0 0 10px #00ffc0, 0 0 20px #00bfff; font-size:0.85rem; animation: pulse 2s infinite;">Mejor Valor</div>
      
      <h3>Suscripci√≥n Anual</h3>
      <p style="font-size:1.5rem;font-weight:700;">‚Ç¨510 / 12 meses <span style="font-size:1rem; color:#00ffc0;">(‚Ç¨43 / mes)</span></p>
      <ul style="text-align:left; margin:15px 0; padding-left:20px; line-height:1.5;">
        <li><em>*Facturado anualmente</em></li>
        <li>Mejor valor total</li>
        <li>Acceso completo a todos los planes</li>
        <li>Soporte 24/7 y prioridad</li>
        <li><strong>Ahorra ‚Ç¨7 / mes comparado con mensual</strong></li>
        <li><strong>Ahorra ‚Ç¨27 / mes comparado con trimestral</strong></li>
      </ul>
      <button style="background:#00ffc0; color:#000; font-weight:700; box-shadow:0 0 25px #00ffc0, 0 0 50px #00bfff inset; animation:pulse 2s infinite;">√öNETE AHORA</button>
    </div>

  </div>
</section>

<!-- Testimonios -->
<section id="testimonios">
  <h2 style="text-align:center;font-size:1.8rem;margin-bottom:25px;">Testimonios Reales</h2>
  <div class="grid">
    <div class="card">
      <p>‚ÄúGracias al plan personalizado de Gerard logr√© perder 12 kg en 4 meses sin sentir hambre y manteniendo mi vida social. Nunca pens√© que ser√≠a posible.‚Äù</p>
      <h4>- Ana Rodr√≠guez, 32 a√±os</h4>
    </div>
    <div class="card">
      <p>‚ÄúMe ayud√≥ a ganar m√∫sculo y mejorar mi fuerza en el gimnasio, adem√°s de ense√±arme a comer sin restricci√≥n. Mis entrenamientos ahora son m√°s efectivos.‚Äù</p>
      <h4>- Luis Mart√≠nez, 28 a√±os</h4>
    </div>
    <div class="card">
      <p>‚ÄúEl seguimiento online fue incre√≠ble. Siempre estaba disponible para resolver dudas y ajustar el plan seg√∫n mi progreso. Me siento m√°s saludable que nunca.‚Äù</p>
      <h4>- Carla P√©rez, 35 a√±os</h4>
    </div>
    <div class="card">
      <p>‚ÄúNunca hab√≠a visto resultados tan r√°pidos y sostenibles. Baj√© grasa, aument√© m√∫sculo y aprend√≠ a mantener h√°bitos sin pasar hambre.‚Äù</p>
      <h4>- Javier G√≥mez, 40 a√±os</h4>
    </div>
  </div>
</section>

<!-- Footer -->
<footer>
  ¬© 2026 Gerard Valls - Nutrici√≥n Profesional
</footer>

<!-- Modal Unificado -->
<div id="modal-unificado" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
background: rgba(0,0,0,0.85); justify-content:center; align-items:center; z-index:2000; opacity:0;">
  <form id="form-unificado" class="premium-modal" data-stripe-plan="">
    <h3 id="modal-title">Oferta Especial EMS</h3>
    <input type="text" name="nombre" placeholder="Nombre completo" required>
    <input type="email" name="email" placeholder="Correo electr√≥nico" required>
    <input type="text" name="plan" id="plan-input" readonly>
    <button type="submit">Enviar y Pagar</button>
    <button type="button" id="close-unificado">Cerrar</button>
  </form>
</div>
<!-- ================================ -->
<!-- MODAL NUEVO: "EMPEZAR MI CAMBIO AHORA" -->
<!-- ================================ -->
<div id="modal-cambio" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
background: rgba(0,0,0,0.85); justify-content:center; align-items:center; z-index:2000; opacity:0;">
  <form id="form-cambio" class="premium-modal" style="transform:scale(0.9); transition: transform 0.3s ease, opacity 0.3s ease;">
    <h3>Empezar Mi Cambio Ahora</h3>
    <input type="text" name="nombre" placeholder="Nombre completo" required>
    <input type="email" name="email" placeholder="Correo electr√≥nico" required>
    <button type="submit">Enviar</button>
    <button type="button" id="close-cambio">Cerrar</button>
  </form>
</div>

<script>
  // ================================
  // Script Modal "Empezar Mi Cambio Ahora"
  // ================================
  const modalCambio = document.getElementById("modal-cambio");
  const formCambio = document.getElementById("form-cambio");

  // Abrir modal al pulsar bot√≥n principal
  document.getElementById("cta-reserva").addEventListener("click", ()=>{
    modalCambio.style.display = "flex";
    setTimeout(()=>{
      modalCambio.style.opacity = "1";
      formCambio.style.transform = "scale(1)";
    }, 10); // peque√±o delay para transici√≥n
    document.body.style.overflow = 'hidden';
  });

  // Funci√≥n para cerrar modal
  function cerrarModalCambio() {
    modalCambio.style.opacity = "0";
    formCambio.style.transform = "scale(0.9)";
    setTimeout(()=>{
      modalCambio.style.display = "none";
      document.body.style.overflow = '';
    }, 300);
  }

  // Cerrar al pulsar bot√≥n
  document.getElementById("close-cambio").addEventListener("click", cerrarModalCambio);

  // Cerrar al hacer click fuera del formulario
  modalCambio.addEventListener("click", e=>{
    if(e.target.id === "modal-cambio") cerrarModalCambio();
  });

  // Env√≠o del formulario a Formspree
  formCambio.addEventListener("submit", e=>{
    e.preventDefault();
    const nombre = e.target.nombre.value;
    const email = e.target.email.value;

    fetch("https://formspree.io/f/YOUR_FORM_ID", {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body: JSON.stringify({ nombre, email })
    }).then(()=>{
      alert("¬°Gracias! Pronto nos pondremos en contacto.");
      cerrarModalCambio();
    }).catch(err=>console.log(err));
  });
</script>

<!-- Scripts -->
<script>
// --- Scroll Animaciones y Three.js ---
let scene = new THREE.Scene();
let camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0,1.5,5);
let renderer = new THREE.WebGLRenderer({antialias:true, alpha:true});
renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5));
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

let ambient = new THREE.AmbientLight(0xffffff,0.6); scene.add(ambient);
let point = new THREE.PointLight(0xffbf00,1.2); point.position.set(5,5,5); scene.add(point);
let geometry = new THREE.TorusKnotGeometry(0.7,0.2,128,32);
let material = new THREE.MeshStandardMaterial({color:0x00ffc0, metalness:0.7, roughness:0.2});
let torus = new THREE.Mesh(geometry, material); scene.add(torus);

let composer = new THREE.EffectComposer(renderer); composer.addPass(new THREE.RenderPass(scene,camera));
let bloom = new THREE.UnrealBloomPass(new THREE.Vector2(window.innerWidth,window.innerHeight),1.2,0.4,0.85);
composer.addPass(bloom);

let controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true; controls.enabled = window.innerWidth > 768;

gsap.to(torus.rotation, {y:Math.PI*2, duration:20, repeat:-1, ease:"linear"});
gsap.utils.toArray("section").forEach(sec=>{
  gsap.from(sec,{opacity:0,y:50,duration:1,scrollTrigger:{trigger:sec,start:"top 80%",toggleActions:"play none none reverse"}});
});

function animate(){
  requestAnimationFrame(animate);
  controls.update();
  composer.render();
}

window.addEventListener("load", ()=>{
  setTimeout(()=>{
    animate();
  }, 2500);
});
</script>

<script>
// --- Modal Unificado + Stripe + Formspree ---
function bloquearScroll(){ document.body.style.overflow='hidden'; }
function liberarScroll(){ document.body.style.overflow=''; }

const modal = document.getElementById("modal-unificado");
const form = document.getElementById("form-unificado");
const stripe = Stripe('TU_PUBLIC_KEY_STRIPE');

const stripePlans = {
  "Suscripci√≥n Anual": "price_1AnualXYZ",
  "Suscripci√≥n Trimestral": "price_1TrimestralXYZ",
  "Suscripci√≥n Mensual": "price_1MensualXYZ"
};


// ABRIR MODAL PREMIUM
document.querySelectorAll(".subscription-card button").forEach(btn=>{
  btn.addEventListener("click", ()=>{
    const planName = btn.closest(".subscription-card").querySelector("h3").textContent;
    document.getElementById("modal-title").textContent = planName;
    document.getElementById("plan-input").value = planName;
    form.dataset.stripePlan = stripePlans[planName];
    modal.style.display="flex";
    modal.style.opacity="1";
    modal.querySelector(".premium-modal").style.transform="scale(1)";
    bloquearScroll();
  });
});

// CERRAR MODAL
document.getElementById("close-unificado").addEventListener("click", closeModal);
modal.addEventListener("click", e=>{ if(e.target.id==="modal-unificado") closeModal(); });

function closeModal(){
  modal.style.display="none";
  modal.style.opacity="0";
  liberarScroll();
}

function openModal(){
  modal.style.display = "flex";

  setTimeout(()=>{
    modal.style.opacity = "1";
    modal.querySelector(".premium-modal").style.transform = "scale(1)";
  }, 10);

  bloquearScroll();
}

// ENV√çO FORMULARIO
form.addEventListener("submit", async e=>{
  e.preventDefault();
  const planID = form.dataset.stripePlan;
  const nombre = e.target.nombre.value;
  const email = e.target.email.value;

  // Formspree
  fetch("https://formspree.io/f/YOUR_FORM_ID", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({ nombre, email, plan:document.getElementById("plan-input").value })
  }).catch(err=>console.log("Error Formspree:",err));

  // Stripe Checkout si hay plan
  if(planID){
    const {error} = await stripe.redirectToCheckout({
      lineItems:[{ price:planID, quantity:1 }],
      mode:'payment',
      successUrl:window.location.href+'?success=true',
      cancelUrl:window.location.href+'?cancel=true',
      customerEmail:email
    });
    if(error){ console.error(error); alert("Hubo un error al redirigir a Stripe. Intenta de nuevo."); }
  }

  closeModal();
});
</script>
<script>
// CONFIGURACI√ìN
const plazasIniciales = 5;      // Plazas al inicio del mes
const diasParaAgotar = 30;      // Total de d√≠as hasta que se agoten todas las plazas (ajusta seg√∫n urgencia)
const parpadeoLimite = 2;       // Si quedan <=2 plazas, parpadea

function actualizarOfertaDiaria() {
  const hoy = new Date();
  const inicioMes = new Date(hoy.getFullYear(), hoy.getMonth(), 1);
  const finMes = new Date(hoy.getFullYear(), hoy.getMonth() + 1, 0);

  const diasTranscurridos = Math.floor((hoy - inicioMes) / (1000 * 60 * 60 * 24));

  // Calcula plazas restantes proporcionalmente a los d√≠as transcurridos
  let plazasRestantes = Math.ceil(plazasIniciales * (1 - diasTranscurridos / diasParaAgotar));
  if(plazasRestantes < 0) plazasRestantes = 0;

  const spanPlazas = document.getElementById("plazas");
  spanPlazas.textContent = plazasRestantes;

  // Parpadeo si quedan pocas plazas
  if(plazasRestantes <= parpadeoLimite && plazasRestantes > 0){
    spanPlazas.style.animation = "parpadeo 1s infinite";
  } else {
    spanPlazas.style.animation = "none";
  }

  // Fecha l√≠mite del mes
  const opciones = { day: 'numeric', month: 'long' };
  document.getElementById("fecha-limite").textContent =
    "Oferta v√°lida hasta el " + finMes.toLocaleDateString('es-ES', opciones);
}

// Animaci√≥n CSS para parpadeo
const style = document.createElement('style');
style.innerHTML = `
@keyframes parpadeo {
  0%, 50%, 100% { opacity: 1; transform: scale(1); }
  25%, 75% { opacity: 0.3; transform: scale(1.2); }
}`;
document.head.appendChild(style);

// Inicializar
actualizarOfertaDiaria();
setInterval(actualizarOfertaDiaria, 1000 * 60 * 60); // Actualiza cada hora
</script>
<!-- Bot√≥n WhatsApp con contador -->
<a href="https://wa.me/34123456789?text=Hola%20Gerard,%20quiero%20m√°s%20info" 
   target="_blank" id="whatsapp-btn-ultimate">
  <i class="fab fa-whatsapp"></i>
  <span id="whatsapp-counter"></span>
</a>

<style>
#whatsapp-btn-ultimate {
  position: fixed;
  bottom: 25px;
  right: 25px;
  background: #25d366;
  color: #fff;
  font-size: 2.2rem;
  border-radius: 50%;
  padding: 16px;
  z-index: 10000;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 0 10px #25d366,0 0 20px #25d366,0 0 30px #25d366,0 0 40px #25d366 inset;
  opacity: 0;
  pointer-events: none;
  transition: transform 0.3s ease, box-shadow 0.3s ease, bottom 0.3s ease, background 0.3s ease, opacity 0.5s ease;
  gap: 8px;
}
#whatsapp-btn-ultimate.show { opacity:1; pointer-events:auto; }
#whatsapp-btn-ultimate:hover { transform: scale(1.15); }

#whatsapp-counter {
  background: rgba(0,0,0,0.6);
  font-size: 0.8rem;
  font-weight: 700;
  padding: 2px 6px;
  border-radius: 8px;
}

/* Parpadeo + pulse */
@keyframes whatsapp-urgent {
  0%,100% { transform: scale(1); box-shadow: 0 0 15px,0 0 30px,0 0 45px,0 0 60px inset; }
  50% { transform: scale(1.2); box-shadow: 0 0 30px,0 0 60px,0 0 90px,0 0 120px inset; }
}

/* Responsive */
@media(max-width:768px){
  #whatsapp-btn-ultimate { font-size:1.8rem; padding:12px; bottom:18px; right:18px; }
  #whatsapp-counter { font-size:0.7rem; padding:1px 4px; }
}
</style>

<script>
setTimeout(()=>{
  const btn = document.getElementById("whatsapp-btn-ultimate");
  const counter = document.getElementById("whatsapp-counter");

  btn.classList.add("show");

  // --- Inicializar plazas desde la p√°gina ---
  const plazasElem = document.getElementById("plazas");
  let plazas = plazasElem ? parseInt(plazasElem.textContent) : 5;
  counter.textContent = plazas;

  // --- Actualizar color seg√∫n oferta ---
  const premiumCard = document.querySelector(".subscription-card.premium");
  const ofertaLimitada = document.getElementById("oferta-limitada");
  
  if(premiumCard){ btn.style.background="#00ffc0"; btn.style.boxShadow="0 0 15px #00ffc0,0 0 30px #00bfff inset"; }
  else if(ofertaLimitada){ btn.style.background="#ffbf00"; btn.style.boxShadow="0 0 15px #ffbf00,0 0 30px #ffbf00 inset"; }
  else { btn.style.background="#25d366"; btn.style.boxShadow="0 0 10px #25d366,0 0 20px #25d366,0 0 30px #25d366,0 0 40px #25d366 inset"; }

  // --- Animaci√≥n de urgencia si plazas ‚â§3 ---
  function checkUrgencia() {
    if(plazas <=3 && plazas >0){ btn.style.animation="whatsapp-urgent 1s infinite alternate"; }
    else { btn.style.animation="none"; }
    counter.textContent = plazas;
  }
  checkUrgencia();

  // --- Scroll din√°mico ---
  let lastScroll = window.scrollY;
  window.addEventListener("scroll", ()=>{
    const currentScroll = window.scrollY;
    btn.style.bottom = (currentScroll > lastScroll ? 15 : 35)+"px";
    lastScroll = currentScroll;
  });

  // --- Actualizar contador autom√°ticamente cada hora seg√∫n tu script de plazas ---
  setInterval(()=>{
    plazas = plazasElem ? parseInt(plazasElem.textContent) : plazas;
    checkUrgencia();
  }, 1000*60*60);

}, 5000);
</script>
<script>
// Abrir autom√°ticamente modal de Suscripci√≥n Anual -10%
window.addEventListener("load", () => {
  const modal = document.getElementById("modal-unificado");
  const form = modal.querySelector(".premium-modal");
  const planName = "Suscripci√≥n Anual"; // nombre exacto que tienes en tu tarjeta
  const stripePlans = {
    "Suscripci√≥n Anual": "price_1AnualXYZ",
    "Suscripci√≥n Trimestral": "price_1TrimestralXYZ",
    "Suscripci√≥n Mensual": "price_1MensualXYZ"
  };

  // Configurar modal con datos de la oferta
  document.getElementById("modal-title").textContent = planName + " -10%";
  document.getElementById("plan-input").value = planName;
  form.dataset.stripePlan = stripePlans[planName];

  // Mostrar modal despu√©s de 2 segundos
  setTimeout(() => {
    modal.style.display = "flex";
    requestAnimationFrame(() => {
      modal.style.opacity = "1";
      form.style.transform = "scale(1)";
    });
    document.body.style.overflow = 'hidden';
  }, 2000);
});

// Funci√≥n para cerrar modal
function closeModal() {
  const modal = document.getElementById("modal-unificado");
  const form = modal.querySelector(".premium-modal");
  modal.style.opacity = "0";
  form.style.transform = "scale(0.9)";
  setTimeout(() => {
    modal.style.display = "none";
    document.body.style.overflow = '';
  }, 300);
}

// Cerrar modal al pulsar bot√≥n
document.getElementById("close-unificado").addEventListener("click", closeModal);

// Cerrar modal al hacer clic fuera del formulario
document.getElementById("modal-unificado").addEventListener("click", e => {
  if (e.target.id === "modal-unificado") closeModal();
});
</script>
</body>
</html>
