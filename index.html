<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gerard Valls - Nutrición Profesional</title>

<!-- Fuente -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Font Awesome CSS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollTrigger.min.js" defer></script>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
/* --- Tus estilos originales arriba --- */
:root{
  --primary:#00ffc0;
  --primary-hover:#00e6b8;
  --dark-bg:#1a1f3f;
  --light-bg:#f5f5f5;
  --text-dark:#e6e6e6;
  --text-light:#222;
  --radius:12px;
  --transition:.5s ease;
}
*{box-sizing:border-box;}
body{margin:0;font-family:'Montserrat',sans-serif;}

/* Botón flotante calculadora */
#calc-btn{
  position:fixed; bottom:220px; right:20px; z-index:1000;
  background:var(--primary); color:#000; border:none;
  border-radius:50%; width:60px; height:60px; font-size:1.5rem;
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; box-shadow:0 5px 15px rgba(0,0,0,0.3); transition:.3s;
}
#calc-btn:hover{transform:scale(1.1); background:var(--primary-hover);}

/* Modal calculadora */
#calorie-modal{
  display:none; justify-content:center; align-items:center;
  position:fixed; inset:0; background:rgba(0,0,0,0.6);
  backdrop-filter:blur(6px); z-index:2000;
}
#calorie-modal .modal-content{
  background:rgba(255,255,255,0.1);
  backdrop-filter:blur(12px);
  border-radius:20px; padding:25px;
  width:90%; max-width:420px; position:relative;
  box-shadow:0 8px 25px rgba(0,0,0,0.3);
  color:white;
}
#calorie-modal .close{
  position:absolute; top:12px; right:15px;
  font-size:20px; cursor:pointer;
  background:rgba(0,0,0,0.3); border-radius:50%;
  padding:5px 10px; color:white;
}
#calorie-modal input, #calorie-modal select{
  width:100%; padding:10px; margin:8px 0;
  border-radius:12px; border:none;
  background:rgba(255,255,255,0.2);
  color:white; font-weight:500;
}
#calorie-modal button[type="submit"]{
  background:var(--primary); color:#000; border:none;
  padding:12px; border-radius:12px; width:100%; font-weight:bold;
  cursor:pointer; transition:0.3s;
}
#calorie-modal button[type="submit"]:hover{background:var(--primary-hover);}
#error-msg{color:#ff4d4d; font-size:.9rem; margin-top:4px;}
#resultado{text-align:center;font-weight:bold;margin-top:10px;}
#toggleChartMode{
  background:rgba(255,255,255,0.2); color:white; border:none;
  padding:8px 16px; border-radius:10px; margin-top:10px; cursor:pointer;
}
</style>
</head>
<body>

<header>
  <h1>Gerard Valls</h1>
  <p>Nutrición personalizada para deportistas y personas activas</p>
  <button id="toggle-theme">Cambiar a modo claro</button>
</header>

<nav>
  <a href="#servicios">Servicios</a>
  <a href="#testimonios">Testimonios</a>
  <a href="#consulta">Formulario</a>
</nav>

<main class="wrapper">
  <!-- --- Todo tu contenido original (servicios, testimonios, formulario) --- -->
  <!-- (lo mantuve exactamente igual, no lo repito aquí por espacio) -->
</main>

<footer>&copy; 2025 Gerard Valls - Todos los derechos reservados.</footer>

<!-- Botones flotantes -->
<button id="whatsapp-btn" aria-label="Abrir chat de WhatsApp"><i class="fab fa-whatsapp"></i></button>
<button id="scrollTopBtn" aria-label="Subir al inicio"><i class="fas fa-arrow-up"></i></button>
<button id="calc-btn" aria-label="Abrir calculadora"><i class="fa-solid fa-calculator"></i></button>

<!-- Modal calculadora -->
<div id="calorie-modal">
  <div class="modal-content">
    <span class="close" onclick="cerrarCalculadora()">✖</span>
    <h2 style="text-align:center;">Calculadora de Calorías</h2>
    <form id="calorie-form">
      <input type="number" id="peso" placeholder="Peso (kg)" required>
      <input type="number" id="altura" placeholder="Altura (cm)" required>
      <input type="number" id="edad" placeholder="Edad" required>
      <select id="sexo" required>
        <option value="">Sexo</option>
        <option value="M">Hombre</option>
        <option value="F">Mujer</option>
      </select>
      <select id="actividad" required>
        <option value="">Nivel de actividad</option>
        <option value="1.2">Sedentario</option>
        <option value="1.375">Ligero</option>
        <option value="1.55">Moderado</option>
        <option value="1.725">Activo</option>
        <option value="1.9">Muy Activo</option>
      </select>
      <select id="objetivo" required>
        <option value="cut">Pérdida de peso</option>
        <option value="maintain">Mantenimiento</option>
        <option value="bulk">Volumen</option>
      </select>
      <button type="submit">Calcular</button>
    </form>
    <p id="resultado"></p>
    <canvas id="macroChart" width="300" height="300"></canvas>
    <button type="button" id="toggleChartMode">Ver en gramos</button>
    <p id="resumen-macros"></p>
  </div>
</div>

<script>
/* --- Tus scripts originales (modo oscuro, GSAP, scroll, WhatsApp, formulario) --- */

/* Abrir/cerrar calculadora */
document.getElementById("calc-btn").addEventListener("click",()=>{document.getElementById("calorie-modal").style.display="flex";});
function cerrarCalculadora(){document.getElementById("calorie-modal").style.display="none";}

/* Lógica calculadora */
const form=document.getElementById("calorie-form");
const resultado=document.getElementById("resultado");
const resumenMacros=document.getElementById("resumen-macros");
let chart,mostrarEnGramos=false;

form.addEventListener("submit",e=>{
  e.preventDefault();
  const peso=parseFloat(document.getElementById("peso").value);
  const altura=parseFloat(document.getElementById("altura").value);
  const edad=parseInt(document.getElementById("edad").value);
  const sexo=document.getElementById("sexo").value;
  const actividad=parseFloat(document.getElementById("actividad").value);
  const objetivo=document.getElementById("objetivo").value;
  if(isNaN(peso)||isNaN(altura)||isNaN(edad)||!sexo||!actividad||!objetivo){
    resultado.textContent="⚠️ Completa todos los campos."; return;
  }
  let bmr=sexo==="M"?10*peso+6.25*altura-5*edad+5:10*peso+6.25*altura-5*edad-161;
  let tdee=bmr*actividad;
  if(objetivo==="cut")tdee-=500;
  if(objetivo==="bulk")tdee+=300;
  resultado.textContent=`Necesitas aproximadamente ${Math.round(tdee)} kcal/día.`;
  const macros={carbs:tdee*0.4,protein:tdee*0.3,fat:tdee*0.3};
  actualizarGrafico(macros);
});

function actualizarGrafico(macros){
  const ctx=document.getElementById("macroChart").getContext("2d");
  const data={labels:["Carbohidratos","Proteínas","Grasas"],datasets:[{data:[
    mostrarEnGramos?macros.carbs/4:macros.carbs,
    mostrarEnGramos?macros.protein/4:macros.protein,
    mostrarEnGramos?macros.fat/9:macros.fat
  ],backgroundColor:["#00bfff","#ff7eb3","#ffe259"],borderWidth:2,borderColor:"rgba(255,255,255,0.8)"}]};
  const options={responsive:true,plugins:{legend:{labels:{color:"white"}},tooltip:{callbacks:{label:ctx=>mostrarEnGramos?`${ctx.label}: ${ctx.formattedValue} g`:`${ctx.label}: ${ctx.formattedValue} kcal`}}}};
  if(chart){chart.data=data; chart.update();}
  else{chart=new Chart(ctx,{type:"doughnut",data,options});}
  resumenMacros.textContent=mostrarEnGramos?`Carbs: ${(macros.carbs/4).toFixed(0)}g | Prot: ${(macros.protein/4).toFixed(0)}g | Grasas: ${(macros.fat/9).toFixed(0)}g`:`Carbs: ${macros.carbs.toFixed(0)} kcal | Prot: ${macros.protein.toFixed(0)} kcal | Grasas: ${macros.fat.toFixed(0)} kcal`;
}

document.getElementById("toggleChartMode").addEventListener("click",()=>{
  mostrarEnGramos=!mostrarEnGramos;
  document.getElementById("toggleChartMode").textContent=mostrarEnGramos?"Ver en kcal":"Ver en gramos";
  form.dispatchEvent(new Event("submit"));
});
</script>
</body>
</html>
