<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Gerard Valls | Sistema Estrat√©gico de Recomposici√≥n Corporal</title>

<meta name="description" content="Especialista en recomposici√≥n corporal en Lleida. Pierde grasa y gana m√∫sculo con un sistema estrat√©gico basado en evidencia cient√≠fica.">

<meta property="og:title" content="Gerard Valls - Recomposici√≥n Corporal Estrat√©gica">
<meta property="og:description" content="Sistema aplicado en m√°s de 200 transformaciones reales.">
<meta property="og:type" content="website">

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:'Montserrat',sans-serif;
  background:#111827;
  color:#f3f4f6;
  line-height:1.6;
}
section{
  padding:80px 20px;
  max-width:1100px;
  margin:auto;
}
h1,h2,h3{
  margin-bottom:20px;
}
button{
  padding:14px 28px;
  border:none;
  border-radius:40px;
  font-weight:600;
  cursor:pointer;
  background:#00ffc0;
  color:#000;
  transition:.3s;
}
button:hover{
  transform:scale(1.05);
}
.hero{
  text-align:center;
  padding:120px 20px 80px;
}
.badge{
  margin-top:10px;
  font-weight:600;
  color:#fbbf24;
}
.plazas{
  margin-top:15px;
  font-weight:600;
}
.bar{
  height:8px;
  background:#333;
  border-radius:10px;
  overflow:hidden;
  margin-top:8px;
}
.bar-fill{
  height:100%;
  width:75%;
  background:#00ffc0;
}
.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
  gap:20px;
}
.card{
  background:#1f2937;
  padding:30px;
  border-radius:20px;
}
.modal-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:flex;
  justify-content:center;
  align-items:center;
  opacity:0;
  pointer-events:none;
  transition:.3s;
}
.modal-overlay.active{
  opacity:1;
  pointer-events:all;
}
.modal{
  background:#1f2937;
  padding:30px;
  border-radius:20px;
  width:90%;
  max-width:400px;
}
input{
  width:100%;
  padding:12px;
  margin-bottom:15px;
  border-radius:10px;
  border:none;
}
footer{
  text-align:center;
  padding:40px 20px;
  font-size:.9rem;
  opacity:.6;
}
</style>
</head>
<body>
<!-- ================= HEADER ================= -->
<header>
  <img src="gerard.jpg" alt="Gerard Valls - Nutricionista Profesional" class="hero-fade" loading="lazy">
  <h1 class="hero-fade">Pierde grasa y gana m√∫sculo sin dejar de comer lo que m√°s te gusta</h1>
  <p class="hero-fade">M√©todo estrat√©gico basado en evidencia cient√≠fica para resultados reales y sostenibles.</p>
  <div class="hero-fade" style="margin-bottom:20px;font-weight:600;color:var(--secondary);">
    ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4.9/5 ‚Ä¢ M√°s de 200 transformaciones reales
  </div>

  <!-- BOTONES PRINCIPALES -->
  <div class="hero-fade" style="display:flex;justify-content:center;gap:12px;flex-wrap:wrap;">
    <button id="cta-reserva" style="background:var(--secondary);color:#000;padding:12px 24px;border:none;border-radius:var(--radius);font-weight:700;cursor:pointer;">
      EMPEZAR MI CAMBIO AHORA
    </button>
    <button onclick="location.href='#planes'" style="background:transparent;color:var(--primary);padding:12px 24px;border:2px solid var(--primary);border-radius:var(--radius);font-weight:600;cursor:pointer;">
      VER PROGRAMAS
    </button>
  </div>

  <p id="header-plazas" style="font-weight:600;font-size:1rem; margin-top:5px;" aria-live="polite">
    Actualmente solo acepto <span id="header-plazas-num">8</span> nuevos clientes este mes.
  </p>
</header>
  <!-- ================= MODAL ================= -->
<div id="modalReserva" class="modal-overlay">
  <div class="modal-box">
    <span class="modal-close">&times;</span>
    <h3>¬°Reserva tu plaza ahora!</h3>
    <form class="modal-form">
      <input type="text" placeholder="Nombre" required>
      <input type="email" placeholder="Email" required>
      <button type="submit">Enviar</button>
    </form>
  </div>
</div>
<nav>
<a href="#servicios">Servicios</a>
<a href="#testimonios">Testimonios</a>
<a href="#consulta">Formulario</a>
<a href="calculadora.html" target="_blank">Calculadora</a>
<a href="imc.html" target="_blank">IMC</a>
</nav>
  
<!-- SECCI√ìN ENFOQUE BASADO EN EVIDENCIA -->
<section id="evidencia" style="max-width:750px;margin:50px auto;text-align:center;">
  <h2>Enfoque Basado en Evidencia</h2>
  <p>La metodolog√≠a aplicada integra principios de:</p>
  <ul style="text-align:left; margin:0 auto; max-width:500px;">
    <li>Balance energ√©tico y periodizaci√≥n nutricional</li>
    <li>Optimizaci√≥n de la s√≠ntesis proteica</li>
    <li>Control de adherencia conductual</li>
    <li>Entrenamiento estructurado progresivo</li>
  </ul>
</section>

<style>
/* Parpadeo plazas urgentes */
@keyframes blinkPlazas {
  0%,50%,100%{opacity:1;}
  25%,75%{opacity:0.4;}
}
.blink { animation: blinkPlazas 1.5s infinite; }
</style>

<script>
// Espera a que cargue todo

  // --- FADE IN SECUENCIAL ---
  gsap.fromTo(".hero-fade", {opacity:0, y:20}, {opacity:1, y:0, duration:1, stagger:0.3, ease:"power2.out"});

  // --- CTA HOVER ---
  const ctas = document.querySelectorAll("header button");
  ctas.forEach(btn => {
    btn.addEventListener("mouseenter", () => {
      gsap.to(btn, { scale:1.05, boxShadow:"0 0 20px #00ffc0, 0 0 40px #ffbf00", duration:0.3 });
    });
    btn.addEventListener("mouseleave", () => {
      gsap.to(btn, { scale:1, boxShadow:"0 8px 20px rgba(0,0,0,0.3)", duration:0.3 });
    });
  });

  // --- CONTADOR DIN√ÅMICO ---
  const PLAZAS_INICIALES = 8;
  const headerPlazas = document.getElementById("header-plazas");
  const headerPlazasNum = document.getElementById("header-plazas-num");
  let plazas = parseInt(localStorage.getItem("plazas") || PLAZAS_INICIALES);
  const mesActual = new Date().getMonth();
  const mesGuardado = parseInt(localStorage.getItem("mesPlazas") || -1);
  if(mesGuardado !== mesActual){
    plazas = PLAZAS_INICIALES;
    localStorage.setItem("mesPlazas", mesActual);
    localStorage.setItem("plazas", plazas);
  }

  function actualizarPlazas() {
    if(plazas > 3){
      headerPlazasNum.textContent = plazas;
      headerPlazasNum.style.color = "#00ffc0";
      headerPlazasNum.style.fontWeight = "bold";
      headerPlazasNum.classList.remove("blink");
    } else if(plazas > 0){
      headerPlazasNum.textContent = plazas;
      headerPlazasNum.style.color = "#ff4d4d";
      headerPlazasNum.style.fontWeight = "bold";
      headerPlazasNum.classList.add("blink");
      gsap.fromTo(headerPlazasNum, { scale:1 }, { scale:1.3, duration:0.3, yoyo:true, repeat:1, ease:"back.out(1.7)" });
    } else {
      headerPlazas.innerHTML = "‚ùå Este mes las plazas est√°n completas. Lista de espera abierta.";
    }
  }
  actualizarPlazas();

  // --- CLICK RESERVA ---
let clickLocked = false;
const btnReserva = document.getElementById("cta-reserva");
const modal = document.getElementById("modalReserva");
const closeModal = document.querySelector(".modal-close");
const form = document.querySelector(".modal-form");

// ABRIR MODAL
btnReserva.addEventListener("click", () => {
  if(plazas > 0){
    modal.classList.add("active");
  }
});

// CERRAR (X)
closeModal.addEventListener("click", () => {
  modal.classList.remove("active");
});

// CERRAR (FUERA)
modal.addEventListener("click", (e) => {
  if(e.target === modal){
    modal.classList.remove("active");
  }
});

// ENVIAR FORMULARIO
form.addEventListener("submit", (e) => {
  e.preventDefault();

  if(plazas > 0){
    plazas--;
    localStorage.setItem("plazas", plazas);
    actualizarPlazas();
    lanzarConfeti(40);

    alert("¬°Perfecto! Te contacto en breve");

    modal.classList.remove("active");
  }
});

  // --- CONFETI ---
  function lanzarConfeti(cantidad=30){
    const colors = ["#00ffc0","#ffbf00","#ff4d4d","#00bfff","#ff00c8"];
    for(let i=0;i<cantidad;i++){
      const conf = document.createElement("div");
      conf.style.cssText = `position:fixed; width:8px; height:8px; background:${colors[Math.floor(Math.random()*colors.length)]}; top:-10px; left:${Math.random()*window.innerWidth}px; opacity:0.9; border-radius:50%; pointer-events:none;`;
      document.body.appendChild(conf);
      gsap.to(conf,{ y:window.innerHeight+50, rotation:Math.random()*360, duration:2+Math.random()*2, ease:"power1.out", onComplete:()=>conf.remove()});
    }
  }
});
</script>
<style>
/* Parpadeo plazas urgentes */

.blink { animation: blinkPlazas 1.5s infinite; }
</style>
  <style>
/* --- CSS GLOBAL --- */

.blink {
  animation: blinkPlazas 1.5s infinite;
}
</style>

<main class="wrapper">

<!-- SERVICIOS -->
<section id="servicios">
<h2>Servicios</h2>
<div class="services">
<div class="service">
<div class="service-inner">
<div class="service-front">
<i class="fas fa-bowl-food icon-planes"></i>
<h3>Planes Personalizados</h3>
<p>Adaptados a tu estilo de vida y objetivos.</p>
</div>
<div class="service-back">
<ul>
<li>Evaluaci√≥n inicial completa</li>
<li>Plan nutricional flexible</li>
<li>Seguimiento quincenal</li>
</ul>
<button onclick="location.href='#consulta'">Solicitar</button>
</div>
</div>
</div>

<div class="service">
<div class="service-inner">
<div class="service-front">
<i class="fas fa-person-running icon-deporte"></i>
<h3>Asesor√≠a Deportiva</h3>
<p>Optimiza tu rendimiento y recuperaci√≥n.</p>
</div>
<div class="service-back">
<ul>
<li>Plan de macronutrientes</li>
<li>Recomendaciones de suplementaci√≥n</li>
<li>Ajuste de cargas de entrenamiento</li>
</ul>
<button onclick="location.href='#consulta'">Solicitar</button>
</div>
</div>
</div>

<div class="service">
<div class="service-inner">
<div class="service-front">
<i class="fas fa-scale-balanced icon-peso"></i>
<h3>P√©rdida de Peso</h3>
<p>Programas sostenibles y personalizados.</p>
</div>
<div class="service-back">
<ul>
<li>Reducci√≥n de grasa saludable</li>
<li>H√°bitos de alimentaci√≥n duraderos</li>
<li>Soporte psicol√≥gico</li>
</ul>
<button onclick="location.href='#consulta'">Solicitar</button>
</div>
</div>
</div>

<div class="service">
<div class="service-inner">
<div class="service-front">
<i class="fas fa-laptop icon-online"></i>
<h3>Consultas Online</h3>
<p>Asesor√≠a desde la comodidad de tu hogar.</p>
</div>
<div class="service-back">
<ul>
<li>Videollamadas semanales</li>
<li>Soporte v√≠a chat</li>
<li>Material exclusivo</li>
</ul>
<button onclick="location.href='#consulta'">Solicitar</button>
</div>
</div>
</div>

</div>
</section> 
<!-- FIN SERVICIOS -->

<!-- PROCESO DE INTERVENCI√ìN NUTRICIONAL -->
<section id="metodologia">
<h2>M√©todo Valls: Intervenci√≥n Estrat√©gica Personalizada</h2>

<p style="max-width:750px;margin:0 auto 40px;">
He desarrollado un sistema estructurado que combina nutrici√≥n flexible,
entrenamiento adaptado y seguimiento continuo para garantizar resultados sostenibles.
</p>

<div class="testimonios-container">

  <div class="testimonio-card">
    <h3>1. Valoraci√≥n Cl√≠nica y Funcional</h3>
    <p>
    Evaluaci√≥n integral del estado nutricional, antecedentes relevantes, h√°bitos, contexto
    personal y objetivos. Se establecen indicadores iniciales que servir√°n como referencia
    para medir la evoluci√≥n.
    </p>
  </div>

  <div class="testimonio-card">
    <h3>2. Planificaci√≥n Estrat√©gica Individualizada</h3>
    <p>
    Dise√±o de un protocolo nutricional y de entrenamiento adaptado a las necesidades
    fisiol√≥gicas y estilo de vida, priorizando adherencia, sostenibilidad y eficacia.
    </p>
  </div>

  <div class="testimonio-card">
    <h3>3. Implementaci√≥n Supervisada</h3>
    <p>
    Aplicaci√≥n estructurada del programa con directrices claras, herramientas pr√°cticas
    y soporte continuo para garantizar correcta ejecuci√≥n.
    </p>
  </div>

    <div class="testimonio-card">
    <h3>4. Seguimiento y Ajuste</h3>
    <p>
    Ajustes estrat√©gicos para maximizar resultados.
    </p>
  </div>

</div>
</section> <!-- ‚úÖ CERRADO CORRECTAMENTE -->
 <!-- RESULTADOS REALES -->
<section id="resultados">
  <h2>Transformaciones Reales</h2>
  <p style="max-width:700px;margin:0 auto 30px;text-align:center;">
    Estos son algunos de los cambios reales de clientes.
  </p>

  <div class="transformaciones-slider">

  <div class="resultado-card">
    <div class="before-after">
      <img src="antes-despues1.jpg" alt="Carlos antes">
      <div class="after-img">
        <img src="antes-despues1-despues.jpg" alt="Carlos despu√©s">
      </div>
      <div class="slider"></div>
    </div>
    <h4>Carlos</h4>
    <p>-8kg en 4 meses</p>
  </div>

  <div class="resultado-card">
    <div class="before-after">
      <img src="antes-despues2.jpg" alt="Laura antes">
      <div class="after-img">
        <img src="antes-despues2-despues.jpg" alt="Laura despu√©s">
      </div>
      <div class="slider"></div>
    </div>
    <h4>Laura</h4>
    <p>M√°s definici√≥n y rendimiento</p>
  </div>

  <div class="resultado-card">
    <div class="before-after">
      <img src="antes-despues3.jpg" alt="David antes">
      <div class="after-img">
        <img src="antes-despues3-despues.jpg" alt="David despu√©s">
      </div>
      <div class="slider"></div>
    </div>
    <h4>David</h4>
    <p>Recomposici√≥n corporal completa</p>
  </div>

</div>
</section>

  <!-- SERVICIOS y otras secciones aqu√≠ ... OMITIDO PARA BREVEDAD ... -->

  <section id="incluye-todos">
    <h2>¬øQu√© incluyen todos los planes?</h2>
    <ul>
      <li><i class="fas fa-check-circle"></i> Rutina de Entrenamiento personalizada</li>
      <li><i class="fas fa-check-circle"></i> Plan de Comidas Personalizado</li>
      <li><i class="fas fa-check-circle"></i> Cambios de comidas y entrenamiento peri√≥dicos</li>
      <li><i class="fas fa-check-circle"></i> Lista de compras descargable</li>
      <li><i class="fas fa-check-circle"></i> Sustituci√≥n de alimentos</li>
      <li><i class="fas fa-check-circle"></i> Adaptaci√≥n a Alergias/intolerancias</li>
      <li><i class="fas fa-check-circle"></i> Registro de Ejercicios y Progreso</li>
      <li><i class="fas fa-check-circle"></i> Atenci√≥n WhatsApp Online 24/7</li>
    </ul>
    <div id="plazas-container" style="max-width:850px;margin:40px auto;padding:30px;border-radius:24px;background:rgba(255,255,255,0.05);backdrop-filter:blur(20px);box-shadow:0 8px 25px rgba(0,0,0,0.3);text-align:center;color:var(--danger);font-weight:bold;font-size:1.2rem;" aria-live="polite">
      <p id="contador-plazas"></p>
      <p style="margin-top:12px;font-size:1rem;">RECUERDA: LAS PLAZAS SON LIMITADAS. ¬°APROVECHA YA!</p>
    </div>
  </section>
</main>
<section id="sobre-mi">
<h2>Sobre Gerard Valls</h2>

<p style="max-width:750px;margin:0 auto 20px;">
Especialista en recomposici√≥n corporal y optimizaci√≥n del rendimiento.
Trabajo con personas que quieren resultados reales sin poner en riesgo su salud.
</p>

<ul style="max-width:600px;margin:0 auto;text-align:left;">
<li>‚úî M√°s de 200 casos reales transformados</li>
<li>‚úî Enfoque basado en evidencia cient√≠fica</li>
<li>‚úî Planes 100% personalizados</li>
<li>‚úî Seguimiento estrat√©gico continuo</li>
</ul>

<p style="margin-top:20px;font-weight:600;">
Mi objetivo no es que hagas dieta. Es que aprendas a mantener resultados para siempre.
</p>
</section>
<!-- TESTIMONIOS -->
<section id="testimonios">
<h2>Resultados Reales</h2>

<div class="testimonios-container">

  <div class="testimonio-card">
    <p class="testimonio-text">
      ‚ÄúPerd√≠ 8kg en 4 meses sin pasar hambre. Aprend√≠ a comer bien y mantener resultados.‚Äù
    </p>
    <div class="testimonio-user">
      <strong>Carlos M.</strong>
      <span><Linyola</span>
    </div>
  </div>

  <div class="testimonio-card">
    <p class="testimonio-text">
      ‚ÄúMe ayud√≥ a mejorar mi rendimiento en competici√≥n. M√°s energ√≠a y mejor recuperaci√≥n.‚Äù
    </p>
    <div class="testimonio-user">
      <strong>Laura G.</strong>
      <span>Tarrega</span>
    </div>
  </div>

  <div class="testimonio-card">
    <p class="testimonio-text">
      ‚ÄúPor fin encontr√© un plan que se adapta a mi trabajo y horarios.‚Äù
    </p>
    <div class="testimonio-user">
      <strong>David R.</strong>
      <span>Mollerusa</span>
    </div>
  </div>

</div>
</section>

<!-- PLANES DE SUSCRIPCI√ìN -->
<section id="planes">
<h2>Programas de Intervenci√≥n</h2>
<p style="max-width:750px; margin:0 auto 40px; text-align:center;">
Programas estructurados de intervenci√≥n nutricional y entrenamiento,
adaptados al nivel de acompa√±amiento y seguimiento requerido.
</p>
<div class="services">

<!-- Suscripci√≥n Anual -->
<div class="service">
<div class="service-inner">
<div class="service-front">
<i class="fas fa-star icon-planes"></i>
<h3>Suscripci√≥n Anual</h3>
<p style="font-size:1.5rem;font-weight:bold;">‚Ç¨349 / 12 meses</p>
<small>*Facturado anualmente</small>
</div>
<div class="service-back">
<ul>
<li>Mejor valor</li>
<li>Acceso completo a todos los planes</li>
<li>Soporte 24/7</li>
</ul>
<button onclick="location.href='#consulta'">√öNETE AHORA</button>
</div>
</div>
</div>

<!-- Suscripci√≥n Trimestral -->
<div class="service">
<div class="service-inner">
<div class="service-front">
<i class="fas fa-calendar-alt icon-deporte"></i>
<h3>Suscripci√≥n Trimestral</h3>
<p style="font-size:1.5rem;font-weight:bold;">‚Ç¨119 / 3 meses</p>
<small>*Facturado trimestral</small>
</div>
<div class="service-back">
<ul>
<li>Plan flexible</li>
<li>Actualizaci√≥n peri√≥dica</li>
<li>Soporte online</li>
</ul>
<button onclick="location.href='#consulta'">√öNETE AHORA</button>
</div>
</div>
</div>

<!-- Suscripci√≥n Mensual -->
<div class="service">
<div class="service-inner">
<div class="service-front">
<i class="fas fa-dollar-sign icon-peso"></i>
<h3>Suscripci√≥n Mensual</h3>
<p style="font-size:1.5rem;font-weight:bold;">‚Ç¨49 / mes</p>
<small>*Facturado mensualmente</small>
</div>
<div class="service-back">
<ul>
<li>Acceso mensual</li>
<li>Ideal para probar</li>
<li>Soporte b√°sico</li>
</ul>
<button onclick="location.href='#consulta'">√öNETE AHORA</button>
</div>
</div>
</div>

</div>
</section>
<section id="garantia">
<h2>Garant√≠a de Compromiso</h2>

<p style="max-width:750px;margin:0 auto;">
Si sigues el plan y aplicas las pautas establecidas que te indico ,
te garantizo ajustes estrat√©gicos ilimitados hasta que veamos progreso real.
Tu transformaci√≥n es un proceso acompa√±ado, no te dejo solo.
</p>
</section>
  <section class="pricing">
  <h2>Programas</h2>

  <div class="pricing-grid">

    <div class="price-card highlight">
      <h3>Anual</h3>
      <p class="price">‚Ç¨349</p>
      <ul>
        <li>Acceso completo</li>
        <li>Soporte 24/7</li>
        <li>Mejor valor</li>
      </ul>
      <button onclick="openModal()">√önete</button>
    </div>

    <div class="price-card">
      <h3>Trimestral</h3>
      <p class="price">‚Ç¨119</p>
      <ul>
        <li>Flexible</li>
        <li>Actualizaciones</li>
        <li>Soporte online</li>
      </ul>
      <button onclick="openModal()">√önete</button>
    </div>

    <div class="price-card">
      <h3>Mensual</h3>
      <p class="price">‚Ç¨49</p>
      <ul>
        <li>Para probar</li>
        <li>Acceso mensual</li>
        <li>Soporte b√°sico</li>
      </ul>
      <button onclick="openModal()">√önete</button>
    </div>

  </div>
</section>
<!-- FORMULARIO -->
<section id="consulta">
  <h2>Formulario de Consulta</h2>
  <form class="glass-form">
  <div class="form-group">
    <input type="text" name="nombre" required placeholder=" ">
    <label>Nombre</label>
    <i class="fas fa-user icon-input"></i>
  </div>
  <div class="form-group">
    <input type="email" name="email" required placeholder=" ">
    <label>Email</label>
    <i class="fas fa-envelope icon-input"></i>
  </div>
  <div class="form-group">
    <textarea name="mensaje" required placeholder=" "></textarea>
    <label>Mensaje</label>
    <i class="fas fa-comment icon-input"></i>
  </div>
  <button type="submit">Enviar</button>
</form>
</section>

</main>

<!-- BOTONES FIJOS -->
<button id="scrollTopBtn"><i class="fas fa-arrow-up"></i></button>
<a id="whatsappBtn" href="https://wa.me/tu-numero" target="_blank"><i class="fab fa-whatsapp"></i></a>
<!-- Modal: colocar aqu√≠ -->
    <span class="modal-close">&times;</span>
    <h3>¬°Reserva tu plaza ahora!</h3>
    <form class="modal-form">
      <input type="text" placeholder="Nombre">
      <input type="email" placeholder="Email">
      <button type="submit">Enviar</button>
    </form>
  </div>
</div>
<footer>
<p>¬© 2026 Gerard Valls. Todos los derechos reservados.</p>
<p style="font-size:0.8rem; opacity:0.7;">La informaci√≥n proporcionada no sustituye el asesoramiento m√©dico individual.</p>
</footer>

<script>
document.addEventListener("DOMContentLoaded", () => {
  // ===== VARIABLES =====
  const PLAZAS_INICIALES = 8;
  const mesActual = new Date().getMonth();
  let plazas = parseInt(localStorage.getItem('plazas') || PLAZAS_INICIALES);
  const mesGuardado = parseInt(localStorage.getItem('mesPlazas') || -1);

  const headerPlazasNum = document.getElementById("header-plazas-num");
  const contador = document.getElementById("contador-plazas");
  const contenedorPlazas = document.getElementById("plazas-container");
  const modal = document.getElementById("modalReserva");
  const closeModal = modal ? modal.querySelector(".modal-close") : null;
  const formModal = modal ? modal.querySelector(".modal-form") : null;
  const RESERVA_BTN_CLASS = ".service-back button, #cta-reserva, .sticky-cta button";

  // ===== RESETEAR PLAZAS AL NUEVO MES =====
  if (mesGuardado !== mesActual) {
    plazas = PLAZAS_INICIALES;
    localStorage.setItem('mesPlazas', mesActual);
    localStorage.setItem('plazas', plazas);
  }

  // ===== FUNCIONES =====
  function actualizarPlazas() {
    // Header
    if(plazas > 0){
      headerPlazasNum.textContent = plazas;
      headerPlazasNum.style.color = plazas <= 3 ? "var(--danger)" : "var(--success)";
      headerPlazasNum.classList.toggle("blink", plazas <= 3);
    } else {
      document.getElementById("header-plazas").innerHTML = "‚ùå Este mes las plazas est√°n completas. Lista de espera abierta.";
    }

    // Contador secci√≥n
    if(plazas > 3){
      contador.innerHTML = `<span style="color:var(--success);font-weight:bold;">¬°Quedan ${plazas} plazas disponibles!</span>`;
      quitarGlow();
      habilitarBotones();
    } else if(plazas > 0){
      contador.innerHTML = `<span class="blink" style="color:var(--danger);font-weight:bold;">‚ö†Ô∏è ¬°Solo quedan ${plazas} plazas!</span>`;
      aplicarGlow();
      habilitarBotones();
    } else {
      contador.innerHTML = `<span style="color:red;font-weight:bold;">‚ùå Todas las plazas est√°n ocupadas.<br>üëâ Lista de espera disponible.</span>`;
      bloquearBotones();
      quitarGlow();
    }

    localStorage.setItem('plazas', plazas);
  }

  function reducirPlaza() {
    if(plazas <= 0) return;
    plazas--;
    actualizarPlazas();
    lanzarConfeti(40);
  }

  function bloquearBotones() {
    document.querySelectorAll(RESERVA_BTN_CLASS).forEach(btn => {
      btn.disabled = true;
      btn.style.opacity = "0.5";
      btn.textContent = "Lista de espera";
      btn.setAttribute("aria-disabled","true");
    });
  }

  function habilitarBotones() {
    document.querySelectorAll(RESERVA_BTN_CLASS).forEach(btn => {
      if(btn.textContent === "Lista de espera") {
        btn.disabled = false;
        btn.style.opacity = "1";
        btn.textContent = "Reservar";
        btn.removeAttribute("aria-disabled");
      }
    });
  }

  function aplicarGlow() {
    contenedorPlazas.classList.add("glow-urgente");
  }

  function quitarGlow() {
    contenedorPlazas.classList.remove("glow-urgente");
    contenedorPlazas.style.transform="scale(1)";
  }

  function lanzarConfeti(cantidad=50){
    const colors=["#00ffc0","#ffbf00","#ff4d4d","#00bfff","#ff00c8"];
    for(let i=0;i<cantidad;i++){
      const conf=document.createElement("div");
      conf.style.cssText=`position:fixed;width:8px;height:8px;background:${colors[Math.floor(Math.random()*colors.length)]};top:-10px;left:${Math.random()*window.innerWidth}px;opacity:0.9;border-radius:50%;pointer-events:none;`;
      document.body.appendChild(conf);
      gsap.to(conf,{y:window.innerHeight+50,rotation:Math.random()*360,duration:2+Math.random()*2,ease:"power1.out",onComplete:()=>conf.remove()});
    }
  }

  // ===== MODAL =====
  function abrirModal() { if(plazas>0) modal.classList.add("active"); }
  function cerrarModal() { modal.classList.remove("active"); }

  if(modal){
  
  if(closeModal){
    closeModal.addEventListener("click", cerrarModal);
  }

  modal.addEventListener("click", (e) => { 
    if(e.target === modal) cerrarModal(); 
  });

}

document.querySelectorAll(RESERVA_BTN_CLASS)
  .forEach(btn => btn.addEventListener("click", abrirModal));

  formModal.addEventListener("submit", (e)=>{
    e.preventDefault();
    if(plazas > 0){
      reducirPlaza();
      alert("¬°Perfecto! Te contacto en breve");
      cerrarModal();
      formModal.reset();
    }
  });

  // ===== SLIDER ANTES/DESPU√âS =====
  document.querySelectorAll(".before-after").forEach(container => {
    const after = container.querySelector(".after-img");
    const slider = container.querySelector(".slider");
    let isDragging = false;

    const setPosition = (x) => {
      const rect = container.getBoundingClientRect();
      let posX = x - rect.left;
      posX = Math.max(0, Math.min(posX, rect.width));
      const percent = (posX / rect.width) * 100;
      after.style.width = percent + "%";
      slider.style.left = percent + "%";
    };

    // Mouse
    slider.addEventListener("mousedown", () => isDragging = true);
    document.addEventListener("mouseup", () => isDragging = false);
    document.addEventListener("mousemove", e => { if(isDragging) setPosition(e.clientX); });

    // Touch
    slider.addEventListener("touchstart", () => isDragging = true);
    document.addEventListener("touchend", () => isDragging = false);
    document.addEventListener("touchmove", e => { if(isDragging) setPosition(e.touches[0].clientX); });

    // Click r√°pido
    container.addEventListener("click", e => { if(e.target !== slider) setPosition(e.clientX); });

    // Inicial
    after.style.width = "50%";
    slider.style.left = "50%";
  });

  // ===== INICIALIZAR =====
  actualizarPlazas();

});
</script>
  <div class="sticky-cta">
  <button onclick="openModal()">Reservar plaza</button>
</div>
        <div class="modal" id="modalReserva">
  <div class="modal-content">
    <span class="modal-close">&times;</span>
    <h3>Reserva tu plaza ahora</h3>

    <form class="modal-form">
      <input type="text" name="nombre" placeholder="Tu nombre" required>
      <input type="email" name="email" placeholder="Tu email" required>
      <button type="submit" class="btn">Quiero mi plaza</button>
    </form>

  </div>
</div>
        <!-- MODAL RESERVA -->
<div class="modal" id="modalReserva">
  <div class="modal-content">
    <span class="modal-close">&times;</span>
    <h3>¬°Reserva tu plaza ahora!</h3>

    <form class="modal-form">
      <input type="text" name="nombre" placeholder="Tu nombre" required>
      <input type="email" name="email" placeholder="Tu email" required>
      <button type="submit" class="btn">Quiero mi plaza</button>
    </form>

  </div>
</div>
</body>
</html>
