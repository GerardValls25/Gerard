<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de CalorÃ­as y Macros</title>
<meta name="description" content="Calculadora profesional de calorÃ­as y macronutrientes basada en tu peso, altura, edad, nivel de actividad y objetivo fitness.">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="icon" href="icon-192.png" type="image/png">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1a1f3f">

<style>
body {
  font-family: 'Montserrat', sans-serif;
  background: #1a1f3f;
  color: white;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh;
  margin: 0;
  padding: 20px;
  transition: background 0.3s ease, color 0.3s ease;
}
@keyframes aparecer {
  0% { opacity: 0; transform: translateY(-20px) scale(0.98); }
  100% { opacity: 1; transform: translateY(0) scale(1); }
}
h1 {
  color: #00ffc0;
  margin-bottom: 10px;
  text-align: center;
  opacity: 0;
  animation: aparecer 0.8s ease forwards;
  animation-delay: 0.2s;
}
.theme-toggle {
  background: #ffffff22;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  margin-bottom: 15px;
  transition: background 0.3s ease, transform 0.2s ease;
}
.theme-toggle:hover { background: #ffffff44; transform: scale(1.05); }
form {
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(12px);
  padding: 30px;
  border-radius: 16px;
  display: flex;
  flex-direction: column;
  gap: 15px;
  max-width: 400px;
  width: 100%;
  opacity: 1;
  transition: opacity 0.4s ease;
}
form.oculto {
  opacity: 0;
  pointer-events: none;
}
input, select {
  appearance: none;
  padding: 12px;
  border-radius: 8px;
  border: none;
  background: rgba(0,0,0,0.3);
  color: white;
  outline: none;
  cursor: pointer;
  transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
}
input:focus, select:focus {
  background: rgba(0,0,0,0.5);
  transform: scale(1.02);
  box-shadow: 0 0 10px #00ffc0;
}
button {
  background: #00ffc0;
  color: black;
  border: none;
  padding: 12px;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.3s ease, transform 0.2s ease;
}
button:disabled { background: gray; cursor: not-allowed; }
button:hover:enabled { background: #00e6b8; transform: scale(1.02); }
#error {
  color: #ff4d4d;
  text-align: center;
  display: none;
  font-size: 0.9rem;
}
#resultado-container {
  display: none;
  flex-direction: column;
  align-items: center;
  gap: 15px;
  margin-top: 20px;
  opacity: 0;
  animation: aparecer 0.8s ease forwards;
}
#resultado {
  font-weight: bold;
  text-align: center;
  width: 100%;
  max-width: 400px;
}
.chart-container {
  max-width: 350px;
  width: 100%;
}
#recalcular-btn {
  background: #00ffc0;
  color: black;
  padding: 12px;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: transform 0.3s ease;
  display: inline-block;
  margin-top: 10px;
  animation: zoomIn 0.4s ease forwards;
}
#recalcular-btn:hover { transform: scale(1.05); }
@keyframes zoomIn {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}
/* Barras de progreso */
.barra {
  height: 10px;
  background: #333;
  border-radius: 6px;
  margin: 5px 0 15px;
  overflow: hidden;
}
.barra > div {
  height: 100%;
  width: 0%;
  border-radius: 6px;
  transition: width 1s ease-in-out;
}
.proteina { background: #00ffc0; }
.grasa { background: #ffcc00; }
.carb { background: #ff4d4d; }
</style>
</head>
<body>

<h1>Calculadora Profesional de CalorÃ­as y Macros</h1>
<button id="theme-toggle" class="theme-toggle">ðŸŒ™ Modo Oscuro</button>

<form id="macro-form">
  <input type="number" id="peso" placeholder="Peso (kg)" min="30" max="250" step="0.1" required>
  <input type="number" id="altura" placeholder="Altura (cm)" min="100" max="250" required>
  <input type="number" id="edad" placeholder="Edad" min="10" max="100" required>
  <select id="genero" required>
    <option value="">Selecciona tu gÃ©nero</option>
    <option value="hombre">Hombre</option>
    <option value="mujer">Mujer</option>
  </select>
  <select id="actividad" required>
    <option value="">Nivel de actividad</option>
    <option value="1.2">Sedentario</option>
    <option value="1.375">Ligero</option>
    <option value="1.55">Moderado</option>
    <option value="1.725">Activo</option>
    <option value="1.9">Muy Activo</option>
  </select>
  <select id="objetivo" required>
    <option value="">Objetivo</option>
    <option value="mantener">Mantener peso</option>
    <option value="perder">Perder grasa</option>
    <option value="ganar">Ganar mÃºsculo</option>
  </select>
  <p id="error" role="alert"></p>
  <button type="submit" disabled>Calcular</button>
</form>

<div id="resultado-container">
  <div id="resultado"></div>
  <div class="chart-container">
    <canvas id="macrosChart"></canvas>
  </div>
  <button id="recalcular-btn">ðŸ”„ Recalcular</button>
</div>

<script>
let chart = null;
const form = document.getElementById("macro-form");
const resultadoContainer = document.getElementById("resultado-container");
const btnCalcular = form.querySelector("button");
const inputs = form.querySelectorAll("input, select");
const resultado = document.getElementById("resultado");
const error = document.getElementById("error");

inputs.forEach(el => el.addEventListener("input", () => {
  btnCalcular.disabled = !form.checkValidity();
}));

form.addEventListener("submit", function (e) {
  e.preventDefault();

  const peso = parseFloat(document.getElementById('peso').value);
  const altura = parseFloat(document.getElementById('altura').value);
  const edad = parseFloat(document.getElementById('edad').value);
  const genero = document.getElementById('genero').value;
  const actividad = parseFloat(document.getElementById('actividad').value);
  const objetivo = document.getElementById('objetivo').value;

  if (isNaN(peso) || isNaN(altura) || isNaN(edad)) {
    error.textContent = "Por favor introduce valores vÃ¡lidos.";
    error.style.display = "block";
    return;
  }
  error.style.display = "none";

  let tmb = genero === 'hombre'
    ? (10 * peso) + (6.25 * altura) - (5 * edad) + 5
    : (10 * peso) + (6.25 * altura) - (5 * edad) - 161;

  let calorias = tmb * actividad;
  if (objetivo === 'perder') calorias *= 0.8;
  if (objetivo === 'ganar') calorias *= 1.15;
  calorias = Math.round(calorias);

  let proteinasPorKg = objetivo === 'ganar' ? 2.2 : objetivo === 'perder' ? 2 : 1.8;
  let proteinas = proteinasPorKg * peso;
  let grasas = (calorias * 0.25) / 9;
  let carbohidratos = (calorias - (proteinas * 4) - (grasas * 9)) / 4;

  form.classList.add("oculto");
  setTimeout(() => {
    form.style.display = "none";
    resultadoContainer.style.display = "flex";
    resultado.innerHTML = `
      <p>CalorÃ­as diarias: <strong>${calorias}</strong></p>
      <p>ProteÃ­nas: <strong>${proteinas.toFixed(0)} g</strong></p>
      <div class="barra"><div class="proteina" style="width:0%"></div></div>
      <p>Grasas: <strong>${grasas.toFixed(0)} g</strong></p>
      <div class="barra"><div class="grasa" style="width:0%"></div></div>
      <p>Carbohidratos: <strong>${carbohidratos.toFixed(0)} g</strong></p>
      <div class="barra"><div class="carb" style="width:0%"></div></div>
    `;
    resultadoContainer.style.opacity = 1;

    setTimeout(() => {
      resultadoContainer.scrollIntoView({ behavior: "smooth", block: "start" });
      // Animar barras
      document.querySelector(".proteina").style.width = Math.min((proteinas / (peso*3))*100, 100) + "%";
      document.querySelector(".grasa").style.width = Math.min((grasas / ((calorias*0.4)/9))*100, 100) + "%";
      document.querySelector(".carb").style.width = Math.min((carbohidratos / ((calorias*0.7)/4))*100, 100) + "%";
    }, 300);

    const data = [(proteinas * 4).toFixed(0), (grasas * 9).toFixed(0), (carbohidratos * 4).toFixed(0)];
    if (!chart) {
      const ctx = document.getElementById('macrosChart').getContext('2d');
      chart = new Chart(ctx, {
        type: 'pie',
        data: {
          labels: ['ProteÃ­nas', 'Grasas', 'Carbohidratos'],
          datasets: [{ data, backgroundColor: ['#00ffc0', '#ffcc00', '#ff4d4d'] }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { labels: { color: document.body.classList.contains("light") ? '#222' : 'white' } }
          }
        }
      });
    } else {
      chart.data.datasets[0].data = data;
      chart.update();
    }
  }, 400);
});

document.getElementById("recalcular-btn").addEventListener("click", () => {
  resultadoContainer.style.display = "none";
  form.style.display = "flex";
  setTimeout(() => form.classList.remove("oculto"), 10);
  window.scrollTo({ top: 0, behavior: "smooth" });
});
</script>

</body>
</html>
